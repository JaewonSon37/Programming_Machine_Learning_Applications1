{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Transforming a term-document matrix using TF-IDF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "from collections import Counter"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>14</th>\n",
       "      <th>15</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>database</td>\n",
       "      <td>24</td>\n",
       "      <td>32</td>\n",
       "      <td>12</td>\n",
       "      <td>6</td>\n",
       "      <td>43</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>index</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>14</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>likelihood</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>27</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>linear</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>25</td>\n",
       "      <td>23</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>21</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>matrix</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>33</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>14</td>\n",
       "      <td>5</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>query</td>\n",
       "      <td>12</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>regression</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>18</td>\n",
       "      <td>32</td>\n",
       "      <td>22</td>\n",
       "      <td>34</td>\n",
       "      <td>17</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>retrieval</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>27</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>sql</td>\n",
       "      <td>21</td>\n",
       "      <td>10</td>\n",
       "      <td>16</td>\n",
       "      <td>7</td>\n",
       "      <td>31</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>vector</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "      <td>8</td>\n",
       "      <td>33</td>\n",
       "      <td>16</td>\n",
       "      <td>14</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           0   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15\n",
       "0    database  24  32  12   6  43   2   0   3   1   6   4   0   0   0   0\n",
       "1       index   9   5   5   2  20   0   1   0   0   0  27  14   3   2  11\n",
       "2  likelihood   0   3   0   0   3   7  12   4  27   4   0   1   0   0   0\n",
       "3      linear   3   0   0   0   0  16   0   2  25  23   7  12  21   3   2\n",
       "4      matrix   1   0   0   0   0  33   2   0   7  12  14   5  12   4   0\n",
       "5       query  12   2   0   0  27   0   0   0   0  22   9   4   0   5   3\n",
       "6  regression   0   0   0   0   0  18  32  22  34  17   0   0   0   0   0\n",
       "7   retrieval   1   0   0   0   2   0   0   0   3   9  27   7   5   4   4\n",
       "8         sql  21  10  16   7  31   0   0   0   0   0   0   0   0   1   0\n",
       "9      vector   2   0   0   2   0  27   4   2  11   8  33  16  14   7   3"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Data = pd.read_csv(\"http://facweb.cs.depaul.edu/mobasher/classes/csc478/data/term-doc-mat.csv\", header = None)\n",
    "Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>14</th>\n",
       "      <th>15</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>24</td>\n",
       "      <td>32</td>\n",
       "      <td>12</td>\n",
       "      <td>6</td>\n",
       "      <td>43</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>14</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>27</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>25</td>\n",
       "      <td>23</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>21</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>33</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>14</td>\n",
       "      <td>5</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>12</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>18</td>\n",
       "      <td>32</td>\n",
       "      <td>22</td>\n",
       "      <td>34</td>\n",
       "      <td>17</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>27</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>21</td>\n",
       "      <td>10</td>\n",
       "      <td>16</td>\n",
       "      <td>7</td>\n",
       "      <td>31</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "      <td>8</td>\n",
       "      <td>33</td>\n",
       "      <td>16</td>\n",
       "      <td>14</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15\n",
       "0  24  32  12   6  43   2   0   3   1   6   4   0   0   0   0\n",
       "1   9   5   5   2  20   0   1   0   0   0  27  14   3   2  11\n",
       "2   0   3   0   0   3   7  12   4  27   4   0   1   0   0   0\n",
       "3   3   0   0   0   0  16   0   2  25  23   7  12  21   3   2\n",
       "4   1   0   0   0   0  33   2   0   7  12  14   5  12   4   0\n",
       "5  12   2   0   0  27   0   0   0   0  22   9   4   0   5   3\n",
       "6   0   0   0   0   0  18  32  22  34  17   0   0   0   0   0\n",
       "7   1   0   0   0   2   0   0   0   3   9  27   7   5   4   4\n",
       "8  21  10  16   7  31   0   0   0   0   0   0   0   0   1   0\n",
       "9   2   0   0   2   0  27   4   2  11   8  33  16  14   7   3"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TD = Data.iloc[:, 1:] # Remove the column containing the terms\n",
    "TD"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>14</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>24</td>\n",
       "      <td>32</td>\n",
       "      <td>12</td>\n",
       "      <td>6</td>\n",
       "      <td>43</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>20</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>14</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>27</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>16</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>25</td>\n",
       "      <td>23</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>21</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>33</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>14</td>\n",
       "      <td>5</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>12</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>18</td>\n",
       "      <td>32</td>\n",
       "      <td>22</td>\n",
       "      <td>34</td>\n",
       "      <td>17</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>27</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>21</td>\n",
       "      <td>10</td>\n",
       "      <td>16</td>\n",
       "      <td>7</td>\n",
       "      <td>31</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>27</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "      <td>8</td>\n",
       "      <td>33</td>\n",
       "      <td>16</td>\n",
       "      <td>14</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   0   1   2   3   4   5   6   7   8   9   10  11  12  13  14\n",
       "0  24  32  12   6  43   2   0   3   1   6   4   0   0   0   0\n",
       "1   9   5   5   2  20   0   1   0   0   0  27  14   3   2  11\n",
       "2   0   3   0   0   3   7  12   4  27   4   0   1   0   0   0\n",
       "3   3   0   0   0   0  16   0   2  25  23   7  12  21   3   2\n",
       "4   1   0   0   0   0  33   2   0   7  12  14   5  12   4   0\n",
       "5  12   2   0   0  27   0   0   0   0  22   9   4   0   5   3\n",
       "6   0   0   0   0   0  18  32  22  34  17   0   0   0   0   0\n",
       "7   1   0   0   0   2   0   0   0   3   9  27   7   5   4   4\n",
       "8  21  10  16   7  31   0   0   0   0   0   0   0   0   1   0\n",
       "9   2   0   0   2   0  27   4   2  11   8  33  16  14   7   3"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "TD.columns= range(15) # Reindex the columns to start from 0\n",
    "TD"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    133\n",
       "1     99\n",
       "2     61\n",
       "3    114\n",
       "4     90\n",
       "5     84\n",
       "6    123\n",
       "7     62\n",
       "8     86\n",
       "9    129\n",
       "dtype: int64"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Compute term frequenices\n",
    "termFreqs = TD.sum(axis = 1)\n",
    "termFreqs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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HbvdzqRJkxg8eDDdunUzOo5H+ve//82WLVvYtGmT0VEEOHToEG+++SZPPPEEzz33HJs2beLRRx/F19eXcePGGR3P4zz77LPYbDYSEhLw8vKiurqal19+mbFjxxodza2poIjLmzBhAjt27GDdunVGR/FIWVlZPPbYY6xYsQJ/f3+j4wg1pb1v37688sorACQmJrJjxw5mz56tgmKATz75hA8++IAPP/yQrl27kpGRwaRJk4iJidHncQlUUIAWLVrg5eVFXl5enf15eXlERUUZlEoAJk6cyLJly1i7di2xsbFGx/FI6enp5Ofn07t379p91dXVrF27lhkzZlBeXo6Xl5eBCT1PdHQ0Xbp0qbOvc+fOzJ8/36BEnu3pp5/m2WefZcyYMQB0796do0ePMnXqVBWUS6A5KICvry99+vRh5cqVtfvsdjsrV64kKSnJwGSey+FwMHHiRBYuXMiqVauIj483OpLHuuaaa9i+fTsZGRm1W9++fRk7diwZGRkqJwYYPHjwj5bd79u3jzZt2hiUyLOVlpZiNtf9OvXy8sJutxuUqGnQCMpZTzzxBOPGjaNv377079+fN954g5KSEu655x6jo3mkCRMm8OGHH7J48WKCg4PJzc0FwGKxEBAQYHA6zxIcHPyjuT+BgYGEh4drTpBBHn/8cQYNGsQrr7zCbbfdxsaNG5kzZw5z5swxOppHGjFiBC+//DKtW7ema9eubN26lddff517773X6GjuzSG1pk+f7mjdurXD19fX0b9/f8c333xjdCSPBZxzmzt3rtHRxOFwXHnllY7HHnvM6BgebenSpY5u3bo5/Pz8HAkJCY45c+YYHclj2Ww2x2OPPeZo3bq1w9/f39GuXTvH//3f/znKy8uNjubWdB8UERERcTmagyIiIiIuRwVFREREXI4KioiIiLgcFRQRERFxOSooIiIi4nJUUERERMTlqKCIiIiIy1FBEREREZejgiIiIiIuRwVFREREXI4KioiIiLgcFRQRERFxOf8PGbfYQ68miw4AAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Plot the distribution\n",
    "plt.plot(sorted(termFreqs, reverse = True))\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    0\n",
       "0  10\n",
       "1  11\n",
       "2   8\n",
       "3  10\n",
       "4   9\n",
       "5   8\n",
       "6   5\n",
       "7   9\n",
       "8   6\n",
       "9  12"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Calculate document frequency for a term 't'\n",
    "DF = pd.DataFrame([(TD != 0).sum(1)]).T\n",
    "DF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]\n",
      " [15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15. 15.]]\n"
     ]
    }
   ],
   "source": [
    "# Create a matrix with all entries\n",
    "NDocs = TD.shape[1]\n",
    "NMatrix = np.ones(np.shape(TD), dtype = float) * NDocs\n",
    "np.set_printoptions(precision = 2, suppress = True, linewidth = 120)\n",
    "print(NMatrix)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58]\n",
      " [0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45 0.45]\n",
      " [0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91]\n",
      " [0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58 0.58]\n",
      " [0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74]\n",
      " [0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91 0.91]\n",
      " [1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58 1.58]\n",
      " [0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74 0.74]\n",
      " [1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32 1.32]\n",
      " [0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32 0.32]]\n"
     ]
    }
   ],
   "source": [
    "# Convert each entry into IDF values\n",
    "IDF = np.log2(np.divide(NMatrix, np.array(DF)))\n",
    "print(IDF)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>14</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>14.04</td>\n",
       "      <td>18.72</td>\n",
       "      <td>7.02</td>\n",
       "      <td>3.51</td>\n",
       "      <td>25.15</td>\n",
       "      <td>1.17</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.75</td>\n",
       "      <td>0.58</td>\n",
       "      <td>3.51</td>\n",
       "      <td>2.34</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>4.03</td>\n",
       "      <td>2.24</td>\n",
       "      <td>2.24</td>\n",
       "      <td>0.89</td>\n",
       "      <td>8.95</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.45</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>12.08</td>\n",
       "      <td>6.26</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.89</td>\n",
       "      <td>4.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.00</td>\n",
       "      <td>2.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.72</td>\n",
       "      <td>6.35</td>\n",
       "      <td>10.88</td>\n",
       "      <td>3.63</td>\n",
       "      <td>24.49</td>\n",
       "      <td>3.63</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.91</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.75</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>9.36</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.17</td>\n",
       "      <td>14.62</td>\n",
       "      <td>13.45</td>\n",
       "      <td>4.09</td>\n",
       "      <td>7.02</td>\n",
       "      <td>12.28</td>\n",
       "      <td>1.75</td>\n",
       "      <td>1.17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.74</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>24.32</td>\n",
       "      <td>1.47</td>\n",
       "      <td>0.00</td>\n",
       "      <td>5.16</td>\n",
       "      <td>8.84</td>\n",
       "      <td>10.32</td>\n",
       "      <td>3.68</td>\n",
       "      <td>8.84</td>\n",
       "      <td>2.95</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>10.88</td>\n",
       "      <td>1.81</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>24.49</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>19.95</td>\n",
       "      <td>8.16</td>\n",
       "      <td>3.63</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.53</td>\n",
       "      <td>2.72</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>28.53</td>\n",
       "      <td>50.72</td>\n",
       "      <td>34.87</td>\n",
       "      <td>53.89</td>\n",
       "      <td>26.94</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0.74</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.47</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.21</td>\n",
       "      <td>6.63</td>\n",
       "      <td>19.90</td>\n",
       "      <td>5.16</td>\n",
       "      <td>3.68</td>\n",
       "      <td>2.95</td>\n",
       "      <td>2.95</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>27.76</td>\n",
       "      <td>13.22</td>\n",
       "      <td>21.15</td>\n",
       "      <td>9.25</td>\n",
       "      <td>40.98</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.32</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0.64</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.64</td>\n",
       "      <td>0.00</td>\n",
       "      <td>8.69</td>\n",
       "      <td>1.29</td>\n",
       "      <td>0.64</td>\n",
       "      <td>3.54</td>\n",
       "      <td>2.58</td>\n",
       "      <td>10.62</td>\n",
       "      <td>5.15</td>\n",
       "      <td>4.51</td>\n",
       "      <td>2.25</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      0      1      2     3      4      5      6      7      8      9      10  \\\n",
       "0  14.04  18.72   7.02  3.51  25.15   1.17   0.00   1.75   0.58   3.51   2.34   \n",
       "1   4.03   2.24   2.24  0.89   8.95   0.00   0.45   0.00   0.00   0.00  12.08   \n",
       "2   0.00   2.72   0.00  0.00   2.72   6.35  10.88   3.63  24.49   3.63   0.00   \n",
       "3   1.75   0.00   0.00  0.00   0.00   9.36   0.00   1.17  14.62  13.45   4.09   \n",
       "4   0.74   0.00   0.00  0.00   0.00  24.32   1.47   0.00   5.16   8.84  10.32   \n",
       "5  10.88   1.81   0.00  0.00  24.49   0.00   0.00   0.00   0.00  19.95   8.16   \n",
       "6   0.00   0.00   0.00  0.00   0.00  28.53  50.72  34.87  53.89  26.94   0.00   \n",
       "7   0.74   0.00   0.00  0.00   1.47   0.00   0.00   0.00   2.21   6.63  19.90   \n",
       "8  27.76  13.22  21.15  9.25  40.98   0.00   0.00   0.00   0.00   0.00   0.00   \n",
       "9   0.64   0.00   0.00  0.64   0.00   8.69   1.29   0.64   3.54   2.58  10.62   \n",
       "\n",
       "     11     12    13    14  \n",
       "0  0.00   0.00  0.00  0.00  \n",
       "1  6.26   1.34  0.89  4.92  \n",
       "2  0.91   0.00  0.00  0.00  \n",
       "3  7.02  12.28  1.75  1.17  \n",
       "4  3.68   8.84  2.95  0.00  \n",
       "5  3.63   0.00  4.53  2.72  \n",
       "6  0.00   0.00  0.00  0.00  \n",
       "7  5.16   3.68  2.95  2.95  \n",
       "8  0.00   0.00  1.32  0.00  \n",
       "9  5.15   4.51  2.25  0.97  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Compute the TF-IDF matrix\n",
    "pd.set_option(\"display.precision\", 2)\n",
    "TD_tfidf = TD * IDF\n",
    "TD_tfidf"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Identify the documents most similar to a specified query with the KNN algorithm with TF-IDF weighted document vectors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "def knn_search(x, D, K, measure):\n",
    "\n",
    "    \"\"\"\n",
    "    Find K nearest neighbors of an instance x among the instances in D.\n",
    "     \n",
    "    Parameters:\n",
    "    x : array-like\n",
    "        The instance for which one wants to find neighbors.\n",
    "    D : array-like\n",
    "        The dataset containing instances to search through.\n",
    "    K : int\n",
    "        The number of nearest neighbors to return.\n",
    "    measure : int\n",
    "        Distance measure to use (0 for Euclidean Distance, 1 for Cosine Similarity).\n",
    "          \n",
    "    Returns:\n",
    "    tuple:\n",
    "        A tuple containing the indices of the K nearest neighbors and their distances.         \n",
    "    \"\"\"\n",
    "    \n",
    "    if measure == 0: \n",
    "        dists = np.sqrt(((D - x) ** 2).sum(axis = 1)) # Calculate Euclidean Distance\n",
    "\n",
    "    elif measure == 1: \n",
    "        D_norm = np.array([np.linalg.norm(D[i]) for i in range(len(D))]) # Compute the norms of each instance in D\n",
    "        x_norm = np.linalg.norm(x) # Compute the norm of the instance x\n",
    "        sims = np.dot(D, x) / (D_norm * x_norm) # Calculate Cosine Similarity\n",
    "        dists = 1 - sims # Convert Cosine Similarity to distance\n",
    "    \n",
    "    # Get the indices of the sorted distances\n",
    "    idx = np.argsort(dists)\n",
    "\n",
    "    return idx[:K], dists"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1.75 9.84 0.   9.94 6.63 5.44 1.58 8.84 0.   7.08]\n"
     ]
    }
   ],
   "source": [
    "# Multiply each term frequency in the query vector x by the corresponding IDF value\n",
    "x = np.array([3, 22, 0, 17, 9, 6, 1, 12, 0, 22])\n",
    "x_tfidf = x * IDF.T[0]\n",
    "print(x_tfidf)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "11    0.01\n",
       "10    0.10\n",
       "14    0.18\n",
       "13    0.20\n",
       "12    0.21\n",
       "9     0.44\n",
       "5     0.55\n",
       "4     0.75\n",
       "8     0.75\n",
       "0     0.77\n",
       "1     0.86\n",
       "7     0.89\n",
       "6     0.90\n",
       "3     0.90\n",
       "2     0.92\n",
       "dtype: float64"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Finding the k = 5 nearest neighbors using inverse of Cosine similarity\n",
    "DT_tfidf = TD_tfidf.T # Transpose to get a document x term matrix\n",
    "DT_array = np.array(DT_tfidf) # Convert the transposed matrix to a numpy array\n",
    "neigh_idx, distances = knn_search(x_tfidf, DT_array, 5, 1)\n",
    "distances = pd.Series(distances, index = DT_tfidf.index)\n",
    "distances.sort_values()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Query:\n",
      "[ 3 22  0 17  9  6  1 12  0 22]\n",
      "\n",
      "Neighbors:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0.00</td>\n",
       "      <td>6.26</td>\n",
       "      <td>0.91</td>\n",
       "      <td>7.02</td>\n",
       "      <td>3.68</td>\n",
       "      <td>3.63</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.16</td>\n",
       "      <td>0.00</td>\n",
       "      <td>5.15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2.34</td>\n",
       "      <td>12.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.09</td>\n",
       "      <td>10.32</td>\n",
       "      <td>8.16</td>\n",
       "      <td>0.0</td>\n",
       "      <td>19.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>10.62</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>0.00</td>\n",
       "      <td>4.92</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.17</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.72</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.95</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.97</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0.00</td>\n",
       "      <td>0.89</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.75</td>\n",
       "      <td>2.95</td>\n",
       "      <td>4.53</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.95</td>\n",
       "      <td>1.32</td>\n",
       "      <td>2.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0.00</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.00</td>\n",
       "      <td>12.28</td>\n",
       "      <td>8.84</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.68</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.51</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       0      1     2      3      4     5    6      7     8      9\n",
       "11  0.00   6.26  0.91   7.02   3.68  3.63  0.0   5.16  0.00   5.15\n",
       "10  2.34  12.08  0.00   4.09  10.32  8.16  0.0  19.90  0.00  10.62\n",
       "14  0.00   4.92  0.00   1.17   0.00  2.72  0.0   2.95  0.00   0.97\n",
       "13  0.00   0.89  0.00   1.75   2.95  4.53  0.0   2.95  1.32   2.25\n",
       "12  0.00   1.34  0.00  12.28   8.84  0.00  0.0   3.68  0.00   4.51"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(\"Query:\")\n",
    "print(x)\n",
    "print(\"\\nNeighbors:\")\n",
    "DT_tfidf.iloc[neigh_idx]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Extend the example to classification using the KNN approach"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>1</th>\n",
       "      <th>2</th>\n",
       "      <th>3</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>6</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>9</th>\n",
       "      <th>Category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>14.04</td>\n",
       "      <td>4.03</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.75</td>\n",
       "      <td>0.74</td>\n",
       "      <td>10.88</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.74</td>\n",
       "      <td>27.76</td>\n",
       "      <td>0.64</td>\n",
       "      <td>Databases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>18.72</td>\n",
       "      <td>2.24</td>\n",
       "      <td>2.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.81</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>13.22</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Databases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7.02</td>\n",
       "      <td>2.24</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>21.15</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Databases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3.51</td>\n",
       "      <td>0.89</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>9.25</td>\n",
       "      <td>0.64</td>\n",
       "      <td>Databases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25.15</td>\n",
       "      <td>8.95</td>\n",
       "      <td>2.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>24.49</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.47</td>\n",
       "      <td>40.98</td>\n",
       "      <td>0.00</td>\n",
       "      <td>Databases</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1.17</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6.35</td>\n",
       "      <td>9.36</td>\n",
       "      <td>24.32</td>\n",
       "      <td>0.00</td>\n",
       "      <td>28.53</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>8.69</td>\n",
       "      <td>Regression</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>0.00</td>\n",
       "      <td>0.45</td>\n",
       "      <td>10.88</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.47</td>\n",
       "      <td>0.00</td>\n",
       "      <td>50.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.29</td>\n",
       "      <td>Regression</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1.75</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3.63</td>\n",
       "      <td>1.17</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>34.87</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.64</td>\n",
       "      <td>Regression</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>0.58</td>\n",
       "      <td>0.00</td>\n",
       "      <td>24.49</td>\n",
       "      <td>14.62</td>\n",
       "      <td>5.16</td>\n",
       "      <td>0.00</td>\n",
       "      <td>53.89</td>\n",
       "      <td>2.21</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3.54</td>\n",
       "      <td>Regression</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3.51</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3.63</td>\n",
       "      <td>13.45</td>\n",
       "      <td>8.84</td>\n",
       "      <td>19.95</td>\n",
       "      <td>26.94</td>\n",
       "      <td>6.63</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.58</td>\n",
       "      <td>Regression</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>2.34</td>\n",
       "      <td>12.08</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.09</td>\n",
       "      <td>10.32</td>\n",
       "      <td>8.16</td>\n",
       "      <td>0.00</td>\n",
       "      <td>19.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>10.62</td>\n",
       "      <td>Information Retrieval</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>0.00</td>\n",
       "      <td>6.26</td>\n",
       "      <td>0.91</td>\n",
       "      <td>7.02</td>\n",
       "      <td>3.68</td>\n",
       "      <td>3.63</td>\n",
       "      <td>0.00</td>\n",
       "      <td>5.16</td>\n",
       "      <td>0.00</td>\n",
       "      <td>5.15</td>\n",
       "      <td>Information Retrieval</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>0.00</td>\n",
       "      <td>1.34</td>\n",
       "      <td>0.00</td>\n",
       "      <td>12.28</td>\n",
       "      <td>8.84</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3.68</td>\n",
       "      <td>0.00</td>\n",
       "      <td>4.51</td>\n",
       "      <td>Information Retrieval</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>0.00</td>\n",
       "      <td>0.89</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.75</td>\n",
       "      <td>2.95</td>\n",
       "      <td>4.53</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.95</td>\n",
       "      <td>1.32</td>\n",
       "      <td>2.25</td>\n",
       "      <td>Information Retrieval</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>0.00</td>\n",
       "      <td>4.92</td>\n",
       "      <td>0.00</td>\n",
       "      <td>1.17</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.72</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2.95</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.97</td>\n",
       "      <td>Information Retrieval</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        0      1      2      3      4      5      6      7      8      9  \\\n",
       "0   14.04   4.03   0.00   1.75   0.74  10.88   0.00   0.74  27.76   0.64   \n",
       "1   18.72   2.24   2.72   0.00   0.00   1.81   0.00   0.00  13.22   0.00   \n",
       "2    7.02   2.24   0.00   0.00   0.00   0.00   0.00   0.00  21.15   0.00   \n",
       "3    3.51   0.89   0.00   0.00   0.00   0.00   0.00   0.00   9.25   0.64   \n",
       "4   25.15   8.95   2.72   0.00   0.00  24.49   0.00   1.47  40.98   0.00   \n",
       "5    1.17   0.00   6.35   9.36  24.32   0.00  28.53   0.00   0.00   8.69   \n",
       "6    0.00   0.45  10.88   0.00   1.47   0.00  50.72   0.00   0.00   1.29   \n",
       "7    1.75   0.00   3.63   1.17   0.00   0.00  34.87   0.00   0.00   0.64   \n",
       "8    0.58   0.00  24.49  14.62   5.16   0.00  53.89   2.21   0.00   3.54   \n",
       "9    3.51   0.00   3.63  13.45   8.84  19.95  26.94   6.63   0.00   2.58   \n",
       "10   2.34  12.08   0.00   4.09  10.32   8.16   0.00  19.90   0.00  10.62   \n",
       "11   0.00   6.26   0.91   7.02   3.68   3.63   0.00   5.16   0.00   5.15   \n",
       "12   0.00   1.34   0.00  12.28   8.84   0.00   0.00   3.68   0.00   4.51   \n",
       "13   0.00   0.89   0.00   1.75   2.95   4.53   0.00   2.95   1.32   2.25   \n",
       "14   0.00   4.92   0.00   1.17   0.00   2.72   0.00   2.95   0.00   0.97   \n",
       "\n",
       "                 Category  \n",
       "0               Databases  \n",
       "1               Databases  \n",
       "2               Databases  \n",
       "3               Databases  \n",
       "4               Databases  \n",
       "5              Regression  \n",
       "6              Regression  \n",
       "7              Regression  \n",
       "8              Regression  \n",
       "9              Regression  \n",
       "10  Information Retrieval  \n",
       "11  Information Retrieval  \n",
       "12  Information Retrieval  \n",
       "13  Information Retrieval  \n",
       "14  Information Retrieval  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Add labels to original data\n",
    "cat_labels = np.array([\"Databases\", \"Databases\", \"Databases\",\n",
    "                       \"Databases\", \"Databases\", \"Regression\",\n",
    "                       \"Regression\", \"Regression\", \"Regression\",\n",
    "                       \"Regression\", \"Information Retrieval\",\n",
    "                       \"Information Retrieval\", \"Information Retrieval\",\n",
    "                       \"Information Retrieval\", \"Information Retrieval\"])\n",
    "cat_labels = pd.Series(cat_labels, index = DT_tfidf.index)\n",
    "DT_tfidf[\"Category\"] = cat_labels\n",
    "DT_tfidf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "def knn_classify(x, D, K, labels, measure):\n",
    "    \n",
    "    neigh_idx, distances = knn_search(x, D, K, measure) # Find the indices and distances of the K nearest neighbors\n",
    "    neigh_labels = labels[neigh_idx] # Get the labels of the nearest neighbors\n",
    "    count = Counter(neigh_labels) # Count occurrences of each label among the neighbors\n",
    "    \n",
    "    print(\"Labels for top\", K, \"neighbors:\", count.most_common())\n",
    "    \n",
    "    return count.most_common(1)[0][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Instance to classify:\n",
      "[ 3 22  0 17  9  6  1 12  0 22]\n",
      "Labels for top 5 neighbors: [('Information Retrieval', 5)]\n",
      "Predicted Category for the new instance:  Information Retrieval\n"
     ]
    }
   ],
   "source": [
    "print(\"Instance to classify:\")\n",
    "print(x)\n",
    "print(\"Predicted Category for the new instance: \", knn_classify(x_tfidf, DT_array, 5, cat_labels, 1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
